{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Home","text":"<p>A command line interface for interacting with user environments on Alps at CSCS.</p>"},{"location":"#getting-uenv","title":"Getting uenv","text":"<p>uenv can be installed loacally by cloning the repository and running the installation script</p> <pre><code>git clone git@github.com:eth-cscs/uenv.git &amp;&amp; ./uenv/install\n</code></pre> <p>For uenv to be available on the command line, an activation script has to be sourced, for which we recommend adding a line to your <code>~/.bashrc</code>. The installation script will prompt you whether it should add the line, and provide a hint on how to update <code>.bashrc</code> if you choose to do it yourself.</p> <p>Info</p> <p>When environments are loaded with, e.g. with <code>uenv start</code>, a new shell is started with the environment mounted at <code>/user-environment</code>. In order for the <code>uenv</code> commands to be available in the new shell, the activation script must be sourced when the shell starts -- which will be performed automatically if added to your <code>.bashrc</code> file.</p> <p>Warning</p> <p>Only bash has been tested so far, though zsh should also work. Create a GitHub issue if there is a shell that you need to support.</p>"},{"location":"#using-uenv","title":"Using uenv","text":""},{"location":"#loading-an-environment","title":"Loading an environment","text":"<pre><code>uenv start $SCRATCH/images/gromacs.sqfs\nuenv start $SCRATCH/images/gromacs.sqfs:/user-environment\n</code></pre> <p>Will start a new shell with the environment <code>gromacs.sqfs</code> mounted at <code>/user-environment</code>.</p> <pre><code>uenv start $SCRATCH/images/gromacs.sqfs debugger.sqfs:/user-tools\n</code></pre> <p>Will start a new shell with the environment <code>gromacs.sqfs</code> mounted at <code>/user-environment</code>, and <code>debugger.sqfs</code> mounted at <code>/user-tools</code></p>"},{"location":"#stopping-an-environment","title":"Stopping an environment","text":"<p>To stop an environment, you can type <code>exit</code> or hit <code>ctrl-d</code> in your terminal, or issuing the following command:</p> <pre><code>uenv stop\n</code></pre> <p>Info</p> <p>The history of commands that were typed in the shell will be lost to the calling shell.</p>"},{"location":"#running-a-command-in-an-environment","title":"Running a command in an environment","text":"<p>The <code>uenv run</code> command can be used to execute a single command in a shell with the desired environment loaded. This is particularly useful for workflows that might execute steps with different environments.</p> <p>Some examples:</p> <pre><code>uenv run $SCRATCH/images/gromacs.sqfs -- ls -ahl /user-environment\nuenv run $SCRATCH/images/gromacs.sqfs:/user-environment $SCRATCH/images/tools.squashfs:/user-tools -- ls -ahl /user-environment /user-tools\n</code></pre> <p>Will start run a command in an environment with the , before returning to the calling shell.</p>"},{"location":"#status","title":"Status","text":"<p>To get the status of all loaded environments:</p> <pre><code>uenv status\n</code></pre>"},{"location":"#modules","title":"Modules","text":"<p>Uenv can be configured to provide modules, however not all uenv provide modules. If a uenv provides modules, they are not directly available for querying and accessing using <code>module avail</code> or <code>module load</code> etc.</p> <p>To find information about which running uenv provide modules, and whether modules have been activated:</p> <pre><code>uenv modules\n</code></pre> <p>If a loaded uenv provides modules, these can be enabled using the <code>modules use</code> command:</p> <pre><code>uenv modules use [environments]\n</code></pre> <p>where <code>[environments]'</code> is a list of uenv whose modules are to be made available.</p> <p>Info</p> <p>If <code>[environments]</code> is not provided, the module files from all loaded uenv that provide modules will be made available.</p> <p>Example 1: use the modules provided by <code>/user-environment</code>: <pre><code>uenv modules use /user-environment\n</code></pre></p> <p>Example 2: use the modules provided by the loaded uenv with name <code>gromacs/2023</code>: <pre><code>uenv modules use gromacs/2023\n</code></pre></p> <p>Example 3: the modules provided by all loaded uenv that provide modules: <pre><code>uenv modules use\n</code></pre></p> <p>Example 4: use the modules provided by the uenv mounted at <code>/user-tools</code> and the uenv with name <code>gromacs/2023</code> <pre><code>uenv modules use gromacs/2023 /user-tools\n</code></pre></p>"},{"location":"implementation/","title":"Implementation","text":""},{"location":"implementation/#environment-variables","title":"Environment Variables","text":""},{"location":"implementation/#variables-set-and-read-by-uenv","title":"Variables set and read by UENV","text":"<ul> <li><code>UENV_MODULE_PATH</code>: a comma separated list of module files that have been loaded.</li> </ul> <p>For example: <pre><code>UENV_MODULE_PATH=/user-environment/modules,/user-tools/modules\nUENV_MODULE_PATH=/user-tools/modules\n</code></pre></p> <ul> <li><code>UENV_VIEW</code>: the view that has been loaded (only one view can be loaded at a time</li> </ul> <pre><code>UENV_VIEW=/user-environment:default\n</code></pre> <ul> <li><code>UENV_CMD</code>: the path to the Python implementation of the tool.</li> </ul> <p>For example, when installed locally by the user <code>bobsmith</code>: <pre><code>UENV_CMD=/users/bobsmith/.local/libexec/uenv-impl\n</code></pre></p>"},{"location":"implementation/#variables-read-by-uenv","title":"Variables read by UENV","text":"<ul> <li><code>UENV_MOUNT_LIST</code>: set by <code>squashfs-mount</code> and the slurm plugin, to record which images have been mounted where.</li> </ul> <p>An example of two images, mounted at <code>/user-environment</code> and <code>/user-tools</code>: <pre><code>UENV_MOUNT_LIST=file:///scratch/bobsmith/qe.squashfs:/user-environment,file:///scratch/bobsmith/ddt.squashfs:/user-tools\n</code></pre></p> <ul> <li><code>SYSTEM</code>: a variable with the cluster name on Alps.</li> </ul>"}]}